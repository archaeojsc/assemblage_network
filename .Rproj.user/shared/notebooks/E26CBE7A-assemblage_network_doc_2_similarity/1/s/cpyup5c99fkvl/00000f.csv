"0",""
"0","# Sørensen–Dice Coefficient for binary incidence matrices"
"0",""
"0","soren_dice_sim_bin <- function(x) {"
"0","  # Calculate the pairwise sums of non-zero matrix elements to find the number"
"0","  # of intersecting elements between each input column"
"0","  bin_intersect_mat <- t(x) %*% x"
"0","  "
"0","  # Calculate the input column sums, to find the individual size of each set"
"0","  col_sum <- apply(x, 2, function(xx)"
"0","    sum(xx != 0))"
"0","  "
"0","  # Calculate the matrix outer sums for pairwise sum of set sizes"
"0","  set_size_sum_mat <- outer(col_sum, col_sum, FUN = ""+"")"
"0","  "
"0","  # Sorenson-Dice index is twice the size of the intersection divided by the"
"0","  # sum of the size for each set"
"0","  sd <- (2 * bin_intersect_mat) / set_size_sum_mat"
"0","  "
"0","  # Set diagonal to identity"
"0","  diag(sd) <- 1"
"0","  "
"0","  # Assign input column names to rows and columns of return matrix"
"0","  dimnames(sd) <- list(colnames(x), colnames(x))"
"0","  return(sd)"
"0","  "
"0","}"
"0",""
