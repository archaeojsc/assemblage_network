"0",""
"0","# Jaccard/Tanimoto similarity index for binary incidence matrices"
"0",""
"0","jaccard_sim_bin <- function(x) {"
"0","  # Calculate the pairwise sums of non-zero matrix elements to find the number"
"0","  # of intersecting elements between each input column"
"0","  bin_intersect_mat <- t(x) %*% x"
"0","  "
"0","  # Calculate the input column sums to find the individual size of each set"
"0","  x_col_sum <- apply(x, 2, function(xx)"
"0","    sum(xx != 0))"
"0","  "
"0","  # Calculate the matrix outer sums for pairwise sum of set sizes"
"0","  set_size_sum_mat <- outer(x_col_sum, x_col_sum, FUN = ""+"")"
"0","  "
"0","  # Jaccard index is intersection of set sizes over the size of the union of"
"0","  # sets"
"0","  jacc <- bin_intersect_mat / (set_size_sum_mat - bin_intersect_mat)"
"0","  "
"0","  # Set diagonal to identity"
"0","  diag(jacc) <- 1"
"0","  "
"0","  # Assign input column names to rows and columns of return matrix"
"0","  dimnames(jacc) <- list(colnames(x), colnames(x))"
"0","  "
"0","  return(jacc)"
"0","}"
"0",""
