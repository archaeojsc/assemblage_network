"0",""
"0","# Szymkiewicz-Simpson overlap coefficient for binary incidence matrices"
"0",""
"0","overlap_coef_bin <- function(x) {"
"0","  # Calculate the pairwise sums of non-zero matrix elements to find the number"
"0","  # of intersecting elements between each input column"
"0","  bin_intersect_mat <- t(x) %*% x"
"0","  "
"0","  # Calculate the input column sums to find the individual size of each set"
"0","  col_sum <- apply(x, 2, function(xx)"
"0","    sum(xx != 0))"
"0","  "
"0","  # Find the smaller of each pair of sets by taking the matrix outer minimum"
"0","  min_set_size_mat <- outer(col_sum, col_sum, FUN = pmin)"
"0","  "
"0","  # Szymkiewicz-Simpson overlap coefficient is the pairwise intersection of two"
"0","  # sets divided by the size of the smaller set"
"0","  ssoc <- bin_intersect_mat / min_set_size_mat"
"0","  "
"0","  # Set diagonal to identity"
"0","  diag(ssoc) <- 1"
"0","  "
"0","  # Assign input column names to rows and columns of return matrix"
"0","  dimnames(ssoc) <- list(colnames(x), colnames(x))"
"0","  "
"0","  return(ssoc)"
"0","}"
"0",""
